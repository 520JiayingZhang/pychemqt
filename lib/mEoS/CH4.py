#!/usr/bin/python
# -*- coding: utf-8 -*-

from lib.meos import MEoS
from lib import unidades

class CH4(MEoS):
    """Ecuación de estado de multiparametros para el metano

    >>> metano=CH4(T=270, P=0.1)
    >>> print "%0.1f %0.5f %0.2f %0.3f %0.5f %0.4f %0.4f %0.2f" % (metano.T, metano.rho, metano.u.kJkg, metano.h.kJkg, metano.s.kJkgK, metano.cv.kJkgK, metano.cp.kJkgK, metano.w)
    270.0 0.71638 -202.56 -62.969 -0.21391 1.6510 2.1754 428.34

    >>> metano=CH4(h=97.111, s=-2.8743)
    >>> print "%0.1f %0.2f %0.2f %0.3f %0.4f %0.4f %0.4f %0.2f" % (metano.T, metano.rho, metano.u.kJkg, metano.h.kJkg, metano.s.kJkgK, metano.cv.kJkgK, metano.cp.kJkgK, metano.w)
    400.0 203.42 -148.68 97.111 -2.8743 2.1333 3.2276 779.35
    """
    name="methane"
    CASNumber="74-82-8"
    formula="CH4"
    synonym="R-50"
    rhoc=unidades.Density(162.66)
    Tc=unidades.Temperature(190.564)
    Pc=unidades.Pressure(4599.2, "kPa")
    M=16.0428      #g/mol
    Tt=unidades.Temperature(90.6941)
    Tb=unidades.Temperature(111.667)
    f_acent=0.01142
    momentoDipolar=unidades.DipoleMoment(0.0, "Debye")
    id=2
    _Tr=unidades.Temperature(186.659809)
    _rhor=unidades.Density(163.413536)
    _w=0.010528102

    CP1={  "ao": 4.00160,
                "an": [], "pow": [],
                "ao_exp": [0.008449, 4.6942, 3.4865, 1.6572, 1.4115],
                "exp": [648, 1957, 3895, 5705, 15080],
                "ao_hyp": [], "hyp": []}

    CP2={  "ao": 4.00088,
                "an": [], "pow": [],
                "ao_exp": [], "exp": [],
                "ao_hyp": [0.76315, 0.0046, 8.74432, -4.46921],
                "hyp": [4.306474465*Tc, 0.936220902*Tc, 5.577233895*Tc, 5.722644361*Tc]}

    CP3={  "ao": 3.5998324,
                "an": [2.614717613495e-1, -5.671028952515e-2, 4.105505612671e-3],
                "pow": [1./3, 2./3, 1],
                "ao_exp": [4.7206715],
                "exp": [2009.15202],
                "ao_hyp": [], "hyp": []}

    CP4={  "ao": 0.15438149595e2,
                "an": [-0.18044750507e7, 0.77426666393e5, -0.13241658754e4, -0.51479005257e-1, 0.10809172196e-3, -0.65501783437e-7],
                "pow": [-3, -2, -1.001, 1, 2, 3],
                "ao_exp": [-0.67490056171e1], "exp": [3000],
                "ao_hyp": [], "hyp": []}


    helmholtz1={
        "__type__": "Helmholtz",
        "__name__": "Helmholtz equation of state for methane of Setzmann and Wagner (1991)",
        "__doc__":  u"""Setzmann, U., Wagner, W. A new equation of state and tables of the thermodynamic properties for methane covering the range from the melting line to 625 K at pressures up to 1000 MPa. J. Phys. Chem. Ref. Data 20 (1991) 1061 – 1155.""",
        "R": 8.31451,
        "cp": CP1,

        "nr1": [0.43679010280e-1, 0.67092361990, -0.17655778590e01, 0.85823302410, -0.12065130520e01, 0.51204672200, -0.40000107910e-3, -0.12478424230e-1, 0.31002697010e-1, 0.17547485220e-2, -0.31719216050e-5, -0.22403468400e-5, 0.29470561560e-6],
        "d1": [1, 1, 1, 2, 2, 2, 2, 3, 4, 4, 8, 9, 10],
        "t1": [-0.5, 0.5, 1., 0.5, 1., 1.5, 4.5, 0., 1., 3., 1., 3., 3.],

        "nr2": [0.18304879090, 0.15118836790, -0.42893638770, 0.68940024460e-1, -0.14083139960e-1, -0.30630548300e-1, -0.29699067080e-1, -0.19320408310e-1, -0.11057399590, 0.99525489950e-1, 0.85484378250e-2, -0.61505556620e-1, -0.42917924230e-1, -0.18132072900e-1, 0.34459047600e-1, -0.23859194500e-2, -0.11590949390e-1, 0.66416936020e-1, -0.23715495900e-1, -0.39616249050e-1, -0.13872920440e-1, 0.33894895990e-1, -0.29273787530e-2],
        "d2": [1, 1, 1, 2, 4, 5, 6, 1, 2, 3, 4, 4, 3, 5, 5, 8, 2, 3, 4, 4, 4, 5, 6],
        "t2": [0., 1., 2., 0., 0., 2., 2., 5., 5., 5., 2., 4., 12., 8., 10., 10., 10., 14., 12., 18., 22., 18., 14.],
        "c2": [1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4],
        "gamma2": [1]*23,

        "nr3": [0.93247999460e-4, -0.62871715180e01,  0.12710694670e02, -0.64239534660e01],
        "d3": [2, 0, 0, 0],
        "t3": [2., 0., 1., 2.],
        "alfa3": [10, 40, 40, 40],
        "beta3": [200, 250, 250, 250],
        "gamma3": [1.07, 1.11, 1.11, 1.11],
        "epsilon3": [1]*4}

    MBWR={
        "__type__": "MBWR",
        "__name__": "MBWR equation of state for ethane of Younglove and Ely (1987)",
        "__doc__":  u"""Younglove, B.A. and Ely, J.F.,"Thermophysical properties of fluids. II. Methane, ethane, propane, isobutane and normal butane," J. Phys. Chem. Ref. Data, 16:577-798, 1987.""",
        "R": 8.31434,
        "cp": CP4,
        "b": [None, 0.9898937956e-4, 0.2199608275, -0.5322788000e1, 0.2021657962e3, -0.2234398926e5, 0.1067940280e-3, 0.1457922469e-2, -0.9265816666e1, 0.2915364732e4, 0.2313546209e-5, 0.1387214274e-2, 0.4780467451e-1, 0.1176103833e-3, -0.1982096730e-2, -0.2512887756, 0.9748899826e-4, -0.1202192137e-5, 0.4128353939e-3, -0.7215842918e-5, 0.5081738255e4, -0.9198903192e6, -0.2732264677e2, 0.7499024351e6, 0.1114060908e-1, 0.1083955159e2, -0.4490960312e-3, -0.1380337847e2, -0.2371902232e-6, 0.3761652197e-3, -0.2375166954e-8, -0.1237640790e-6, 0.6766926453e-5]}

    GERG={
        "__type__": "Helmholtz",
        "__name__": "Helmholtz equation of state for methane of Kunz and Wagner (2004).",
        "__doc__":  u"""Kunz, O., Klimeck, R., Wagner, W., Jaeschke, M. "The GERG-2004 Wide-Range Reference Equation of State for Natural Gases and Other Mixtures," to be published as a GERG Technical Monograph, Fortschr.-Ber. VDI, VDI-Verlag, Düsseldorf, 2006.""",
        "R": 8.314472,
        "cp": CP2,

        "nr1":  [0.57335704239162, -0.16760687523730e1, 0.23405291834916, -0.21947376343441, 0.16369201404128e-1, 0.15004406389280e-1],
        "d1": [1, 1, 2, 2, 4, 4],
        "t1": [0.125, 1.125, 0.375, 1.125, 0.625, 1.5],

        "nr2": [0.98990489492918e-1, 0.58382770929055, -0.7478686756039, 0.30033302857974, 0.20985543806568, -0.18590151133061e-1, -0.15782558339049, 0.12716735220791, -0.32019743894346e-1, -0.68049729364536e-1, 0.24291412853736e-1, 0.51440451639444e-2, -0.19084949733532e-1, 0.55229677241291e-2, -0.44197392976085e-2, 0.40061416708429e-1, -0.33752085907575e-1, -0.25127658213357e-2],
        "d2": [1, 1, 1, 2, 3, 6, 2, 3, 3, 4, 4, 2, 3, 4, 5, 6, 6, 7],
        "t2": [0.625, 2.625, 2.75, 2.125, 2, 1.75, 4.5, 4.75, 5, 4, 4.5, 7.5, 14, 11.5, 26, 28, 30, 16],
        "c2": [1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 3, 3, 3, 6, 6, 6, 6],
        "gamma2": [1]*18}

    helmholtz3={
        "__type__": "Helmholtz",
        "__name__": "Helmholtz equation of state for methane of Friend et al. (1989)",
        "__doc__":  u"""Friend, D.G., Ely, J.F., and Ingham, H., "Thermophysical Properties of Methane," J. Phys. Chem. Ref. Data, 18(2):583-638, 1989.""",
        "R": 8.31451,
        "cp": CP3,

        "nr1":  [0.384436099659, -0.179692598800e1, 0.329444947369, 0.226312728442e-1, 0.759236768798e-1, 0.693758447259e-1, 0.241163263947e-1, 0.107009920854e-1, -0.380933275164e-1, 0.471537561143e-3, 0.556607678805e-3, 0.548759346533e-6, -0.999632699967e-4],
        "d1": [1, 1, 1, 2, 2, 2, 3, 3, 3, 6, 7, 7, 8],
        "t1": [0, 1.5, 2.5, -0.5, 1.5, 2, 0, 1, 2.5, 0, 2, 5, 2],

        "nr2": [-0.128087979280, 0.380198873377e-1, 0.139226650551, -0.874996348859e-1, -0.334894165760e-2, -0.517576297122e-1, 0.252835179116e-1, 0.518703205950e-3, -0.166770594525e-2, -0.607401927389e-3, -0.972915359991e-4, -0.298844010462e-4, -0.130940111124e-1, 0.198175833798e-1, 0.208465762327e-1, -0.358025052631e-1, -0.203486851741, 0.215964755088, -0.429340628249e-2],
        "d2": [1, 1, 2, 2, 3, 3, 5, 6, 7, 8, 10, 2, 3, 3, 4, 4, 5, 5, 5],
        "t2": [5, 6, 3.5, 5.5, 3, 7, 6, 8.5, 4, 6.5, 5.5, 22, 11, 18, 11, 23, 17, 18, 23],
        "c2": [2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 4, 4, 4, 4, 4, 4, 4, 4],
        "gamma2": [1]*19}

    helmholtz4={
        "__type__": "Helmholtz",
        "__name__": "short Helmholtz equation of state for methane of Span and Wagner (2003)",
        "__doc__":  u"""Span, R., Wagner, W. Equations of state for technical applications. II. Results for nonpolar fluids. Int. J. Thermophys. 24 (2003), 41 – 109.""",
        "R": 8.31451,
        "cp": CP1,

        "nr1": [0.89269676, -0.25438282e1, 0.64980978, 0.20793471e-1, 0.70189104e-1, 0.23700378e-3],
        "d1": [1, 1, 1, 2, 3, 7],
        "t1": [0.25, 1.125, 1.5, 1.375, 0.25, 0.875],

        "nr2": [0.16653334, -0.43855669e-1, -0.1572678, -0.35311675e-1, -0.29570024e-1, 0.14019842e-1],
        "d2": [2, 5, 1, 4, 3, 4],
        "t2": [0.625, 1.75, 3.625, 3.625, 14.5, 12.],
        "c2": [1, 1, 2, 2, 3, 3],
        "gamma2": [1]*6}

    eq=helmholtz1, MBWR, GERG, helmholtz3, helmholtz4

    _surface={"sigma": [0.0308936, 0.0249105, -0.0068276], "exp": [1.25, 2.25, 3.25]}
    _dielectric={"eq": 3, "Tref": 273.16, "rhoref": 1000.,
                            "a0": [],  "expt0": [], "expd0": [],
                            "a1": [6.5443, 0.0133], "expt1": [0, 1], "expd1": [1, 1],
                            "a2": [8.4578, 3.7196, -352.97, -100.65], "expt2": [0, 1, 0, 1], "expd2": [2, 2, 3, 3]}
    _melting={"eq": 1, "Tref": Tt, "Pref": 11.696, "a1": [1, 0.247568e5, -0.736602e4, -0.247568e5, 0.736602e4], "exp1": [0, 1.85, 2.1, 0, 0], "a2": [], "exp2": [], "a3": [], "exp3": []}
    _sublimation={"eq": 3, "Tref": Tt, "Pref": 11.696, "a1": [], "exp1": [],"a2": [-12.84], "exp2": [1],"a3": [], "exp3": []}
    _vapor_Pressure={ "eq": 6, "ao": [-6.036219, 1.409353, -0.4945199, -1.443048], "exp": [2, 3, 4, 9]}
    _liquid_Density={ "eq": 3, "ao": [1.9906389, -0.78756197, 0.036976723], "exp": [0.354, 0.5, 2.5]}
    _vapor_Density={ "eq": 4, "ao": [-1.880284, -2.8526531, -3.000648, -5.251169, -13.191859, -37.553961], "exp": [1.062, 2.5, 4.5, 7.5, 12.5, 23.5]}

    visco0={"eq": 4, "omega": 1,
                "__doc__": """S.E.Quinones-Cisneros, M.L. Huber and U.K. Deiters, "Reference Correlation for the Viscosity of Methane," in preparation, for submission to J. Phys. Chem. Reference Data, 2007.""",
                "__name__": "Quiñones-Cisneros (2007)",
                "Tref": 190.564, "muref": 1.0,
                "ek": 174., "sigma": 0.36652, "n_chapman": 0,
                "n_ideal": [0.028790445329809258e3, -0.08883896490106571e3, 0.0854278871311819e3, -0.018038099301409677e3],
                "t_ideal": [0, 0.25, 0.5, 0.75],

                "a": [-3.388499774849180e-5, 1.357751056436950e-5, 0.0],
                "b": [2.757578135745610e-5, -3.437257168370160e-5, 0.0],
                "c": [2.891185964062900e-5, -9.980820268031560e-6, -2.073683069612580e-7],
                "A": [1.599928656708460e-8, -1.914111948640950e-9, 0.0],
                "B": [-2.591543952601510e-9, 3.260205780076830e-9, 0.0],
                "C": [-3.328762135404730e-8, 1.806469586530360e-7, 4.380464338668540e-10],
                "D": [3.151938769973220e-12, 0.0, 0.0 ]}

    visco1={"eq": 1, "omega": 1,
                "collision": [0.215309028, -0.46256942 , 0.051313823, 0.030320660, -0.0070047029],
                "__name__": "Vogel (2000)",
                "__doc__": """Vogel, E., Wilhelm, J., Kuechenmeister, C., and Jaesche, M., "High-precision viscosity measurements on methane," High Temp. - High Pressures, 32(1):73-81, 2000.""",
                "ek": 160.78, "sigma": 0.37333,
                "n_chapman": 0.0855422/M**0.5,

                "n_virial": [-19.572881, 219.73999, -1015.3226, 2471.01251, -3375.1717, 2491.6597, -787.26086, 14.085455, -0.34664158],
                "t_virial": [0, -0.25, -0.5, -0.75, -1, -1.25, -1.5, -2.5, -5.5],
                "Tref_virial": 159.7, "etaref_virial": 0.0306525,

                "Tref_res": 190.564, "rhoref_res": 10.139*M, "etaref_res": 1,
                "n_packed": [3.10860501398],
                "t_packed": [0],
                "n_poly": [-3.02256904347, 17.6965130175, 3.11150846518, -21.5685107769, 0.672852409238, 10.2387524315, -1.09330775541, -1.20030749419, -21.1009923406],
                "t_poly": [0, -1, 0, -1, 0, -1, 0, -1, 0],
                "d_poly": [2, 2, 3, 3, 4, 4, 5, 5, 1],
                "g_poly": [0, 0, 0, 0, 0, 0, 0, 0, -1],
                "c_poly": [0, 0, 0, 0, 0, 0, 0, 0, 0],
                "n_num": [21.1009923406],
                "t_num": [0],
                "d_num": [1],
                "g_num": [0],
                "c_num": [0],
                "n_den": [1, -1],
                "t_den": [0, 0],
                "d_den": [0, 1],
                "g_den": [1, 0],
                "c_den": [0, 0]}

    visco2={"eq": 2, "omega": 2,
                "__name__": "Younglove (1987)",
                "__doc__": """Younglove, B.A. and Ely, J.F.,"Thermophysical properties of fluids. II. Methane, ethane, propane, isobutane and normal butane," J. Phys. Chem. Ref. Data, 16:577-798, 1987.""",
                "ek": 168., "sigma": 0.368,
                "n_chapman": 0.1069188/M**0.5,
                "F": [0.16969859271, -0.13337234608e-1, 0.140e1, 0.168e3],
                "E": [-0.1620427429e2, 0.4270589027e3, 0.1402596278e2, -0.3916837745e4, -0.3477099090e-1, 0.2136542674e2, 0.1436802482e4],
                "rhoc": 10.15}

    visco3={"eq": 1, "omega": 2,
                "__name__": "Friend (1989)",
                "__doc__": """Friend, D.G., Ely, J.F., and Ingham, H., "Tables for the Thermophysical Properties of Methane," NIST Technical Note 1325, 1989.""",
                "Tref": 174., "etaref": 10.0,
                "ek": 174., "sigma": 0.36652,
                "n_chapman": 0.14105376/M**0.5,

                "Tref_res": 190.551, "rhoref_res": 10.139*M, "etaref_res": 12.149,
                "n_num": [0.41250137, -0.14390912, 0.10366993, 0.40287464, -0.24903524, -0.12953131, 0.06575776, 0.02566628, -0.03716526],
                "t_num": [0, -1, 0, -1, -1.5, 0, -2, 0, -1],
                "d_num": [1, 1, 2, 2, 2, 3, 3, 4, 4],
                "g_num": [0, 0, 0, 0, 0, 0, 0, 0, 0],
                "c_num": [0, 0, 0, 0, 0, 0, 0, 0, 0],
                "n_den": [1.0, -0.38798341, 0.03533815],
                "t_den": [0, 0, -1.0],
                "d_den": [0, 1, 1],
                "g_den": [0, 0, 0],
                "c_den": [0, 0, 0]}

    _viscosity=visco0, visco1, visco2, visco3

    thermo0={"eq": 1, "critical": "CH4",
                "__name__": "Friend (1989)",
                "__doc__": """Friend, D.G., Ely, J.F., and Ingham, H., "Tables for the Thermophysical Properties of Methane," NIST Technical Note 1325, 1989.""",

                "Tref": 174., "kref": 1e-3,
                "no": [1.45885, -0.4377162, 0],
                "co": [0, -1, -96],

                "Trefb": 190.551, "rhorefb": 10.139, "krefb": 6.29638e-3,
                "nb": [1.5554612, 1., 2.4149207, 0.55166331, -0.52837734, 0.073809553, 0.24465507, -0.047613626],
                "tb": [0, 0, 0, 0, 0, -1, 0, -1],
                "db": [2, 0, 1, 3, 4, 4, 5, 5],
                "cb": [0, -99, 0, 0, 0, 0, 0, 0]}


    thermo1={"eq": 2, "omega": 2,
                "__name__": "Younglove (1987)",
                "__doc__": """Younglove, B.A. and Ely, J.F.,"Thermophysical properties of fluids. II. Methane, ethane, propane, isobutane and normal butane," J. Phys. Chem. Ref. Data, 16:577-798, 1987.""",
                "visco": visco2,
                "n_chapman": 0.1069188,
                "G": [0.1346953698e1, -0.3254677753],
                "E": [0.2325800819e-2, -0.2477927999, 0.3880593713e2, -0.1579519146e-6, 0.3717991328e-2, -0.9616989434, -0.3017352774e-1, 0.4298153386],

                "critical": 2,
                "X": [37.42368, 3.16714, 0.78035, 0.60103],
                "Z": 6.512707e-10}

    _thermal=thermo0, thermo1

